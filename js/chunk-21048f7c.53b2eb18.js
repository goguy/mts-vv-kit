(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21048f7c"],{1820:function(t,e,r){"use strict";r.r(e);var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("v-container",{staticClass:"pa-0",attrs:{id:"standard_work",fluid:""}},[r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{attrs:{cols:"2"}}),r("v-col",[r("v-container",{staticClass:"mt-5"},[r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{staticClass:"mr-auto",attrs:{cols:"auto"}},[r("p",{staticClass:"text-h5 font-weight-regular"},[t._v(" "+t._s(t.workName)+" ")])]),r("v-col",{attrs:{cols:"auto"}},[r("p",{staticClass:"text-h6 font-weight-regular"},[r("v-icon",[t._v(" mdi-account")]),t._v("   "+t._s(this.GE_WORKER.name)+" ")],1)])],1)],1)],1),r("v-col",{attrs:{cols:"2"}})],1),r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{attrs:{cols:"12",sm:"12",md:"1",lg:"2"}}),r("v-col",[r("v-card",{staticClass:"pa-5 grey lighten-5"},[r("v-sheet",{staticClass:"blue-grey darken-4",attrs:{height:"50",dark:""}},[r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("div",[r("div",{staticClass:"d-inline float-left"},[r("v-btn",{staticClass:"blue-grey darken-4",attrs:{small:"",dark:""},on:{click:function(e){e.stopPropagation(),t.playerDrawer=!t.playerDrawer}}},[t.playerDrawer?r("v-icon",[t._v(" mdi-close ")]):r("v-icon",[t._v(" mdi-view-list ")])],1)],1),r("div",{staticClass:"d-inline float-right font-weight-thin"},[r("v-btn",{staticClass:"blue-grey darken-4",attrs:{"x-small":""},on:{click:t.previousPlayer}},[r("v-icon",[t._v(" mdi-chevron-left ")])],1),t._v(" "+t._s(t.playerListCurrentIndex+1)+" / "+t._s(t.videoList.length)+" "),r("v-btn",{staticClass:"blue-grey darken-4",attrs:{"x-small":""},on:{click:t.nextPlayer}},[r("v-icon",[t._v(" mdi-chevron-right ")])],1)],1),r("p",{staticClass:"text-h5 text-center font-weight-light"},[t._v(" "+t._s(t.playerTitle)+" ")])])])],1)],1),r("v-sheet",{staticClass:"vjs-wrap overflow-hidden",staticStyle:{position:"relative"}},[r("v-navigation-drawer",{staticClass:"blue-grey lighten-5",attrs:{absolute:"",temporary:""},model:{value:t.playerDrawer,callback:function(e){t.playerDrawer=e},expression:"playerDrawer"}},[r("v-list",{attrs:{nav:"",dense:"",shaped:""}},[r("v-list-item-group",{attrs:{color:"primary"},model:{value:t.playerListCurrentIndex,callback:function(e){t.playerListCurrentIndex=e},expression:"playerListCurrentIndex"}},t._l(t.normalPlayList,(function(e){return r("v-list-item",{key:e.name,attrs:{link:""},on:{click:function(r){return t.vjsPlayerListLink(e.disp_ord)}}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"text-subtitle-1",domProps:{textContent:t._s(e.name)}})],1)],1)})),1)],1)],1),r("video-player-list",{attrs:{options:t.videoOptions,playerList:t.videoList},on:{player:t.onPlayer,playerState:t.onPlayerState}}),r("v-fab-transition",[r("v-btn",{directives:[{name:"show",rawName:"v-show",value:t.playerBtnNextHidden,expression:"playerBtnNextHidden"}],staticClass:"mb-7 text-subtitle-1",attrs:{depressed:"",color:"pink",dark:"",small:"",absolute:"",bottom:"",right:""},on:{click:t.nextPlayer}},[t._v(" next "),r("v-icon",[t._v("mdi-chevron-right")])],1)],1)],1),r("v-fab-transition",[r("v-overlay",{attrs:{absolute:t.playerOverAbsolute,value:t.playerOverlay}})],1)],1),r("v-row",[r("v-col",{attrs:{align:"center",justify:"space-around"}},["normal"===t.workStep.type&&"0"===t.workStep.step?[r("div",{staticClass:"d-inline float-left mt-2"}),r("div",{staticClass:"d-inline float-right mt-2"}),r("div",{attrs:{clsaa:"d-inline text-center mt-2"}},[!1===t.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:t.btnPlayWork}},[t._v(" 작업재개 ")]):!0===t.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:t.btnStopWork}},[t._v(" 작업중지 ")]):t._e()],1)]:"normal"===t.workStep.type&&"last"===t.workStep.step?[r("div",{staticClass:"d-inline float-left mt-2"},[r("v-btn",{staticClass:"ma-3",attrs:{depressed:"",dark:"",large:"",color:"blue-grey",elevation:"1"},on:{click:function(e){return t.validate("Y")}}},[t._v(" 작업결과보고서 ")])],1),r("div",{staticClass:"d-inline float-right mt-2"}),r("div",{attrs:{clsaa:"d-inline text-center mt-2"}},[!1===t.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:t.btnPlayWork}},[t._v(" 작업재개 ")]):!0===t.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:t.btnStopWork}},[t._v(" 작업중지 ")]):t._e()],1)]:t._e()],2)],1)],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"3",lg:"2"}},[r("v-sheet",{staticClass:"ml-3 mr-5"},[r("v-sheet",[r("v-subheader",{staticClass:"text-subtitle-1"},[t._v("작업시각")]),r("p",[r("v-icon",{staticClass:"ml-5"},[t._v("mdi-clock")]),r("span",{staticClass:"ml-3"},[t._v(t._s(t.workingTime))]),r("span",{staticClass:"ml-5"},[t._v("[ "+t._s(t.makeWorkingTime(t.workTotalTime))+" ]")])],1)],1),r("v-divider"),r("v-sheet",{staticClass:"mt-4 text-center"},[r("p",[t._v(t._s(t.setWorkerEquipment()))])]),r("v-divider")],1)],1)],1)],1)},n=[],o=r("b85c"),a=r("1da1"),s=r("5530"),l=(r("96cf"),r("d3b7"),r("a15b"),r("4de4"),r("b0c0"),r("2f62")),c=r("0063"),u=r("7e91"),d=(r("fda2"),r("7aaa")),p=r("6c14"),h="workStore",_="workerStore",y="tdmotionStore",m="workTdmotionStore",v="workerTdmotionStore",f="resultStore",k="resultItemStore",E="equipmentStore",T="workEquipmentStore",O="workerEquipmentStore",I={name:"standard_work",components:{VideoPlayerList:u["a"]},mixins:[d["a"],p["a"]],data:function(){return{player:null,response:null,playerTitle:"",playerListPrevousIndex:-1,playerListCurrentIndex:0,playerListNextIndex:1,playerListLastIndex:-1,videoOptions:{controls:!0,fluid:!0,techOrder:["html5"],plugins:{playlist:{autoadvance:!0}}},videoList:[],isBtnPlayer:!1,normalVideoLength:0,playerDrawer:null,isTimerRunning:!1,timeWork:0,timerInterval:null,playerBtnNextHidden:!1,playerOverlay:!1,playerOverAbsolute:!0,workStep:{type:"normal",step:"0"},resultItemPayload:{index:0,resultItem:[]},gitUrl:"https://goguy.github.io/mts-vv-kit"}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["c"])(h,["GE_WORK_LIST"])),Object(l["c"])(_,["GE_WORKER"])),Object(l["c"])(y,["GE_TDMOTION_LIST"])),Object(l["c"])(m,["GE_WORK_TDMOTION_LIST"])),Object(l["c"])(v,["GE_WORKER_TDMOTION_LIST"])),Object(l["c"])(E,["GE_EQUIPMENT_LIST"])),Object(l["c"])(T,["GE_WORK_EQUIPMENT_LIST"])),Object(l["c"])(O,["GE_WORKER_EQUIPMENT_LIST"])),Object(l["c"])(f,["GE_RESULT","GE_RESULT_LIST"])),Object(l["c"])(k,["GE_RESULT_ITEM","GE_RESULT_ITEM_LIST"])),{},{normalPlayList:function(){var t=this,e=c["a"].from(this.GE_TDMOTION_LIST).join(c["a"].from(this.GE_WORK_TDMOTION_LIST).where((function(e){return e.work_id===t.GE_WORKER.work_id&&"normal"===e.type})),(function(t){return t.motion_id}),(function(t){return t.motion_id}),(function(t,e){return Object(s["a"])(Object(s["a"])({},t),e)})).orderBy((function(t){return t.disp_ord})).toArray();return e},workName:function(){var t=this,e=this.GE_WORK_LIST.filter((function(e){return e.work_id===t.GE_WORKER.work_id}));return e[0].name},workingTime:function(){var t=this.timeWork/60,e=parseInt(t),r=Math.round(60*(t-e));return e<10&&(e="0"+e),r<10&&(r="0"+r),e+":"+r},workTotalTime:function(){var t=this,e=this.GE_WORK_LIST.filter((function(e){return e.work_id===t.GE_WORKER.work_id}));return e[0].time},checkWatchAllVideo:function(){return this.queryWorkTdmotion.length===this.workAndworkerTdmotion.length},queryWorkTdmotion:function(){var t=this,e=c["a"].from(this.GE_TDMOTION_LIST).where((function(t){return"normal"===t.type})).join(c["a"].from(this.GE_WORK_TDMOTION_LIST).where((function(e){return e.work_id===t.GE_WORKER.work_id})),(function(t){return t.motion_id}),(function(t){return t.motion_id}),(function(t,e){return Object(s["a"])(Object(s["a"])({},t),e)})).toArray();return e},queryWorkerTdmotion:function(){var t=this,e=c["a"].from(this.GE_TDMOTION_LIST).where((function(t){return"normal"===t.type})).join(c["a"].from(this.GE_WORKER_TDMOTION_LIST).where((function(e){return e.worker_id===t.GE_WORKER.worker_id})),(function(t){return t.motion_id}),(function(t){return t.motion_id}),(function(t,e){return Object(s["a"])(Object(s["a"])({},t),e)})).toArray();return e},workAndworkerTdmotion:function(){var t=c["a"].from(this.queryWorkTdmotion).join(c["a"].from(this.queryWorkerTdmotion),(function(t){return t.motion_id}),(function(t){return t.motion_id}),(function(t,e){return Object(s["a"])(Object(s["a"])({},t),{},{right:e})})).toArray();return t}}),watch:{timeWork:function(t){this.checkWatchAllVideo&&this.setWorkStep("normal","last")}},created:function(){this.normalVideoLength=this.videoListQuery("normal")},mounted:function(){this.response&&this.onPlayer(),this.startTimer()},beforeDestroy:function(){this.player&&this.player.dispose(),clearInterval(this.timerInterval)},methods:Object(s["a"])(Object(s["a"])({},Object(l["b"])(k,["AC_RESULT_ITEM_EDIT"])),{},{initQuery:function(){},onPlayer:function(t){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.player=t,r.next=3,e.player.playlist(e.videoList);case 3:e.response=r.sent,e.playerListLastIndex=e.player.playlist.lastIndex();case 5:case"end":return r.stop()}}),r)})))()},onPlayerState:function(t){switch(t.type){case"play":console.log("player : "+t.type),this.playerBtnNextHidden=!1,this.isBtnPlayer=!0;break;case"pause":console.log("player : "+t.type),this.isBtnPlayer=!1;break;case"ended":console.log("player : "+t.type),this.videoList&&this.tdmotionWorker(this.GE_WORKER.worker_id,this.videoList[this.playerListCurrentIndex].sources[0].motion_id),this.videoList.length-this.playerListCurrentIndex>1&&(this.playerBtnNextHidden=!0);break;case"loadeddata":this.playerListPrevousIndex=this.player.playlist.previousIndex(),this.playerListCurrentIndex=this.player.playlist.currentItem(),this.playerListNextIndex=this.player.playlist.nextIndex(),this.changePlayerTitle(),console.log("player : "+t.type);break;case"waiting":console.log("player : "+t.type);break;case"playing":console.log("player : "+t.type);break;case"canplay":console.log("player : "+t.type);break;case"canplaythrough":console.log("player : "+t.type);break;default:console.log("default")}this.historyActivityWorker(this.getActivityId("작업하기"),this.GE_WORKER.worker_id,"TDMOTION",this.videoList[this.playerListCurrentIndex].sources[0].motion_id,t.type,this.playerListCurrentIndex)},btnPlayWork:function(){this.player.play()},btnStopWork:function(){this.player.pause()},changePlayerTitle:function(){this.playerTitle=this.videoList[this.playerListCurrentIndex].sources.length>0?this.videoList[this.playerListCurrentIndex].sources[0].name:"noTitle"},vjsPlayerListLink:function(t){console.log("n : "+t),this.player.playlist.currentItem(t-1)},previousPlayer:function(){this.player.playlist.previous()},nextPlayer:function(){this.player.playlist.next()},videoListQuery:function(t){var e=this;try{var r=c["a"].from(this.GE_TDMOTION_LIST).join(c["a"].from(this.GE_WORK_TDMOTION_LIST).where((function(r){return r.work_id===e.GE_WORKER.work_id&&r.type===t})),(function(t){return t.motion_id}),(function(t){return t.motion_id}),(function(t,e){return Object(s["a"])(Object(s["a"])({},t),e)})).orderBy((function(t){return t.disp_ord})).toArray();this.videoList=[];var i,n=Object(o["a"])(r);try{for(n.s();!(i=n.n()).done;){var a=i.value;this.videoList.push({sources:[{motion_id:a.motion_id,disaster_id:a.disaster_id,name:a.name,order:a.disp_ord-1,src:this.getVideoUrl(a.video_url),type:a.video_type}],poster:this.getImageUrl(a.img_url)})}}catch(l){n.e(l)}finally{n.f()}return this.videoList.length}catch(u){console.log("e : "+u)}},getWorkTime:function(){var t=this,e=this.GE_WORK_LIST.filter((function(e){return e.work_id===t.GE_WORKER.work_id}));return e.length>0?e[0].time:100},setWorkerEquipment:function(){var t="보호구장비 "+this.queryWorkAndWorkerEquipment("protect").length+"/"+this.queryWorkEquipment("protect").length+", 안전장비"+this.queryWorkAndWorkerEquipment("safety").length+"/"+this.queryWorkEquipment("safety").length;return t},queryWorkAndWorkerEquipment:function(t){var e=c["a"].from(this.queryWorkEquipment(t)).join(c["a"].from(this.queryWorkerEquipment(t)),(function(t){return t.equipment_id}),(function(t){return t.equipment_id}),(function(t,e){return Object(s["a"])(Object(s["a"])({},t),{},{right:e})})).toArray();return e},queryWorkEquipment:function(t){var e=this,r=c["a"].from(this.GE_EQUIPMENT_LIST).join(c["a"].from(this.GE_WORK_EQUIPMENT_LIST).where((function(t){return t.work_id===e.GE_WORKER.work_id})),(function(t){return t.equipment_id}),(function(t){return t.equipment_id}),(function(t,e){return Object(s["a"])(Object(s["a"])({},t),e)})).where((function(e){return e.type===t})).orderBy((function(t){return t.disp_ord})).toArray();return r},queryWorkerEquipment:function(t){var e=this,r=c["a"].from(this.GE_EQUIPMENT_LIST).join(c["a"].from(this.GE_WORKER_EQUIPMENT_LIST).where((function(t){return t.worker_id===e.GE_WORKER.worker_id})),(function(t){return t.equipment_id}),(function(t){return t.equipment_id}),(function(t,e){return Object(s["a"])(Object(s["a"])({},t),e)})).where((function(e){return e.type===t})).orderBy((function(t){return t.disp_ord})).toArray();return r},startTimer:function(){var t=this;this.isTimerRunning=!0,this.timerInterval=setInterval((function(){t.timeWork++}),1e3)},validate:function(t){var e=this.checkTypeResult();e?(this.recordWorkerResultItem("work_confirm",t),this.nextStep()):alert("작업 확인 여부 업데이트 실패")},nextStep:function(){this.checkWorkTime(),this.activityWorker(this.GE_WORKER.worker_id,this.getActivityId("작업하기")),this.dialog=!1,this.$router.push("/work/reporting")},checkWorkTime:function(){var t=this.checkTypeResult();this.timeWork>this.workTotalTime?t?this.recordWorkerResultItem("work_time","N"):alert("작업시간 준수여부 업데이트 실패"):t?this.recordWorkerResultItem("work_time","Y"):alert("작업시간 준수여부 업데이트 실패")},setWorkStep:function(t,e){this.workStep.type=t,this.workStep.step=e},makeWorkingTime:function(t){var e=t/60,r=parseInt(e),i=Math.round(60*(e-r));return r<10&&(r="0"+r),i<10&&(i="0"+i),r+":"+i},checkTypeResult:function(){var t=this,e=this.GE_WORK_LIST.filter((function(e){return e.work_id===t.GE_WORKER.work_id}))[0].type,r=this.GE_RESULT_LIST.filter((function(t){return t.type===e}));return r.length>0},recordWorkerResultItem:function(t,e){var r=this,i=this.GE_WORK_LIST.filter((function(t){return t.work_id===r.GE_WORKER.work_id}))[0].type,n=this.GE_RESULT_LIST.filter((function(t){return t.type===i}))[0];n=this.GE_RESULT_ITEM_LIST.filter((function(e){return e.result_id===n.result_id&&e.name===t}))[0],n.worker_id=this.GE_WORKER.worker_id,n.is_yn=e,this.resultItemPayload.index=n.result_item_id,this.resultItemPayload.resultItem=n,this.AC_RESULT_ITEM_EDIT(this.resultItemPayload)},getVideoUrl:function(t){var e=t.substring(t.lastIndexOf("/"),t.length);return e=this.gitUrl+"/videos"+e,e},getImageUrl:function(t){var e=t.substring(t.lastIndexOf("/"),t.length);return e=this.gitUrl+"/images"+e,e}})},b=I,w=(r("c8b6"),r("2877")),g=r("6544"),L=r.n(g),W=r("8336"),R=r("b0af"),S=r("62ad"),x=r("a523"),j=r("ce7e"),C=r("0789"),G=r("132d"),P=r("8860"),q=r("da13"),K=r("5d23"),N=r("1baa"),M=r("f774"),D=r("a797"),V=r("0fd9"),U=r("8dd9"),A=r("e0c7"),B=Object(w["a"])(b,i,n,!1,null,null,null);e["default"]=B.exports;L()(B,{VBtn:W["a"],VCard:R["a"],VCol:S["a"],VContainer:x["a"],VDivider:j["a"],VFabTransition:C["c"],VIcon:G["a"],VList:P["a"],VListItem:q["a"],VListItemContent:K["a"],VListItemGroup:N["a"],VListItemTitle:K["c"],VNavigationDrawer:M["a"],VOverlay:D["a"],VRow:V["a"],VSheet:U["a"],VSubheader:A["a"]})},"9a8a":function(t,e,r){},c8b6:function(t,e,r){"use strict";r("9a8a")}}]);
//# sourceMappingURL=chunk-21048f7c.53b2eb18.js.map