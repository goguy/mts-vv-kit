(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70db0c69"],{"2b97":function(e,t,r){},"4a58":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{staticClass:"pa-0",attrs:{id:"choke_work",fluid:""}},[r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{attrs:{cols:"2"}}),r("v-col",[r("v-container",{staticClass:"mt-5"},[r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{staticClass:"mr-auto",attrs:{cols:"auto"}},[r("p",{staticClass:"text-h5 font-weight-regular"},[e._v(" "+e._s(e.workName)+" ")])]),r("v-col",{attrs:{cols:"auto"}},[r("p",{staticClass:"text-h6 font-weight-regular"},[r("v-icon",[e._v(" mdi-account")]),e._v("   "+e._s(this.GE_WORKER.name)+" ")],1)])],1)],1)],1),r("v-col",{attrs:{cols:"2"}})],1),r("v-row",{attrs:{"no-gutters":""}},[r("v-col",{attrs:{cols:"12",sm:"12",md:"1",lg:"2"}}),r("v-col",[r("v-card",{directives:[{name:"show",rawName:"v-show",value:!e.isShowOxygenVideoPlay,expression:"!isShowOxygenVideoPlay"}],staticClass:"pa-5 grey lighten-5"},[r("v-sheet",{staticClass:"blue-grey darken-4",attrs:{height:"50",dark:""}},[r("v-row",[r("v-col",{attrs:{cols:"12"}},[r("div",[r("div",{staticClass:"d-inline float-left"},[r("v-btn",{staticClass:"blue-grey darken-4",attrs:{small:"",dark:""},on:{click:function(t){t.stopPropagation(),e.playerDrawer=!e.playerDrawer}}},[e.playerDrawer?r("v-icon",[e._v(" mdi-close ")]):r("v-icon",[e._v(" mdi-view-list ")])],1)],1),r("div",{staticClass:"d-inline float-right font-weight-thin"},[r("v-btn",{staticClass:"blue-grey darken-4",attrs:{"x-small":""},on:{click:e.previousPlayer}},[r("v-icon",[e._v(" mdi-chevron-left ")])],1),e._v(" "+e._s(e.playerListCurrentIndex+1)+" / "+e._s(e.videoList.length)+" "),r("v-btn",{staticClass:"blue-grey darken-4",attrs:{"x-small":""},on:{click:e.nextPlayer}},[r("v-icon",[e._v(" mdi-chevron-right ")])],1)],1),r("p",{staticClass:"text-h5 text-center font-weight-light"},[e._v(" "+e._s(e.playerTitle)+" ")])])])],1)],1),r("v-sheet",{staticClass:"vjs-wrap overflow-hidden",staticStyle:{position:"relative"}},[r("v-navigation-drawer",{staticClass:"blue-grey lighten-5",attrs:{absolute:"",temporary:""},model:{value:e.playerDrawer,callback:function(t){e.playerDrawer=t},expression:"playerDrawer"}},[r("v-list",{attrs:{nav:"",dense:"",shaped:""}},[r("v-list-item-group",{attrs:{color:"primary"},model:{value:e.playerListCurrentIndex,callback:function(t){e.playerListCurrentIndex=t},expression:"playerListCurrentIndex"}},e._l(e.subjectPlayerList,(function(t){return r("v-list-item",{key:t.name,attrs:{link:""},on:{click:function(r){return e.vjsPlayerListLink(t.disp_ord)}}},[r("v-list-item-content",[r("v-list-item-title",{staticClass:"text-subtitle-1",domProps:{textContent:e._s(t.name)}})],1)],1)})),1)],1)],1),r("video-player-list",{attrs:{options:e.videoOptions,playerList:e.videoList},on:{player:e.onPlayer,playerState:e.onPlayerState}}),r("v-fab-transition",[r("v-btn",{directives:[{name:"show",rawName:"v-show",value:e.playerBtnNextHidden,expression:"playerBtnNextHidden"}],staticClass:"mb-7 text-subtitle-1",attrs:{depressed:"",color:"pink",dark:"",small:"",absolute:"",bottom:"",right:""},on:{click:e.nextPlayer}},[e._v(" next "),r("v-icon",[e._v("mdi-chevron-right")])],1)],1)],1),r("v-fab-transition",[r("v-overlay",{attrs:{absolute:e.playerOverAbsolute,value:e.playerOverlay}})],1)],1),r("v-card",{directives:[{name:"show",rawName:"v-show",value:e.isShowOxygenVideoPlay,expression:"isShowOxygenVideoPlay"}],staticClass:"pa-5 grey lighten-5"},[r("v-sheet",{staticClass:"vjs-wrap"},[r("video-playering",{ref:"measureVideoPlayering"})],1)],1),r("v-row",[r("v-col",{attrs:{align:"center",justify:"space-around"}},["normal"===e.workStep.type&&"0"===e.workStep.step?[r("div",{staticClass:"d-inline float-left mt-2"}),r("div",{staticClass:"d-inline float-right mt-2"},[e.playerListCurrentIndex+1===e.outbreakPlayerIndex?r("v-btn",{staticClass:"mt-3",attrs:{depressed:"",dark:"",large:"",color:"green",elevation:"1"},on:{click:e.btnOxygenDensity}},[e.isPrepareOutbreak?r("v-progress-circular",{staticClass:"mr-2",attrs:{indeterminate:"",color:"white",size:"20"}}):e._e(),e._v(" 산소농도측정 ")],1):e._e()],1),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.isShowOxygenVideoPlay,expression:"!isShowOxygenVideoPlay"}],attrs:{clsaa:"d-inline text-center mt-2"}},[!1===e.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:e.btnPlayWork}},[e._v(" 작업재개 ")]):!0===e.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:e.btnStopWork}},[e._v(" 작업중지 ")]):e._e()],1)]:"outbreak"===e.workStep.type&&"1"===e.workStep.step?[r("div",{staticClass:"d-inline float-left mt-2"},["green"===e.oxygenDensity.state.color&&"green"===e.workerHealth.state.color?r("v-btn",{staticClass:"ma-3",attrs:{depressed:"",dark:"",large:"",color:"pink",elevation:"1"},on:{click:e.btnCopeOutbreak}},[e._v(" 자력탈출 ")]):e._e()],1),r("div",{attrs:{clsaa:"d-inline text-center mt-2"}},[!1===e.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:e.btnPlayWork}},[e._v(" 작업재개 ")]):!0===e.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:e.btnStopWork}},[e._v(" 작업중지 ")]):e._e()],1)]:"normal"===e.workStep.type&&"1"===e.workStep.step?[r("div",{staticClass:"d-inline float-left mt-2"},["ended"===e.playerVideoState?r("v-btn",{staticClass:"ma-3",attrs:{depressed:"",dark:"",large:"",color:"blue-grey",elevation:"1"},on:{click:e.btnNomalVideoPlayer}},[e._v(" 작업진행 ")]):e._e()],1),r("div",{attrs:{clsaa:"d-inline text-center mt-2"}},[!1===e.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:e.btnPlayWork}},[e._v(" 작업재개 ")]):!0===e.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:e.btnStopWork}},[e._v(" 작업중지 ")]):e._e()],1)]:"normal"===e.workStep.type&&"last"===e.workStep.step?[r("div",{staticClass:"d-inline float-left mt-2"},[r("v-btn",{staticClass:"ma-3",attrs:{depressed:"",dark:"",large:"",color:"blue-grey",elevation:"1"},on:{click:function(t){return e.validate("Y")}}},[e._v(" 작업결과보고서 ")])],1),r("div",{attrs:{clsaa:"d-inline text-center mt-2"}},[!1===e.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:e.btnPlayWork}},[e._v(" 작업재개 ")]):!0===e.isBtnPlayer?r("v-btn",{staticClass:"ma-2",attrs:{depressed:"",dark:"",large:"",color:"primary",elevation:"1"},on:{click:e.btnStopWork}},[e._v(" 작업중지 ")]):e._e()],1)]:"outbreak"===e.workStep.type&&"last"===e.workStep.step?[r("div",{staticClass:"d-inline float-left mt-2"},[r("v-btn",{attrs:{depressed:"",dark:"",large:"",color:"pink",elevation:"1"},on:{click:function(t){return e.validate("N")}}},[e._v(" 작업장탈출 ")])],1),r("div",{staticClass:"d-inline float-right mt-2"}),r("div",{attrs:{clsaa:"d-inline text-center mt-2"}})]:e._e()],2)],1)],1),r("v-col",{attrs:{cols:"12",sm:"12",md:"3",lg:"2"}},[r("v-sheet",{staticClass:"ml-3 mr-5"},[r("v-sheet",[r("v-subheader",{staticClass:"text-subtitle-1"},[e._v("작업시각")]),r("p",[r("v-icon",{staticClass:"ml-5"},[e._v("mdi-clock")]),r("span",{staticClass:"ml-3"},[e._v(e._s(e.workingTime))]),r("span",{staticClass:"ml-5"},[e._v("[ "+e._s(e.makeWorkingTime(e.workTotalTime))+" ]")])],1)],1),r("v-divider"),r("v-sheet",{staticClass:"mt-4 text-center"},[r("p",[e._v(e._s(e.setWorkerEquipment()))])]),r("v-divider"),r("v-sheet",[r("v-subheader",{staticClass:"text-subtitle-1"},[e._v("작업자건강(100점 만점)")]),r("v-list-item",[r("v-list-item-avatar",[r("v-avatar",{attrs:{color:e.workerHealth.state.color,size:"25"}})],1),r("v-list-item-content",[r("v-list-item-title",[e._v(e._s(e.workerHealthValue))])],1),r("v-list-item-content",[r("v-slider",{attrs:{max:e.workerHealth.range.max,min:e.workerHealth.range.min,value:e.workerHealthValue,color:"black","track-color":"grey",vertical:""}})],1)],1),r("v-list-item",[r("v-list-item-content",[r("v-list-item-title",[e._v(e._s(e.workerHealth.state.msg))])],1)],1)],1),r("v-divider"),r("v-sheet",[r("v-subheader",[r("v-btn",{staticClass:"text-subtitle-1",attrs:{plain:""},on:{click:e.btnOxygenDensityHealthObstacle}},[e._v(" 산소농도(%) ")])],1),r("v-list-item",[r("v-list-item-avatar",[r("v-avatar",{attrs:{color:e.oxygenDensity.state.color,size:"25"}})],1),r("v-list-item-content",[r("v-list-item-title",[e._v(e._s(e.oxygenDensityGauge))])],1),r("v-list-item-content",[r("v-slider",{attrs:{max:e.oxygenDensity.range.max,min:e.oxygenDensity.range.min,value:e.oxygenDensityGauge,color:"black","track-color":"grey",vertical:""}})],1),r("v-fade-transition",[r("v-overlay",{attrs:{value:e.isPrepareOutbreak,absolute:""}},[r("v-progress-circular",{attrs:{indeterminate:"",size:"64"}})],1)],1)],1),r("v-list-item",[r("v-list-item-content",[r("v-list-item-title",[e._v(e._s(e.oxygenDensity.state.msg))])],1)],1)],1),e.isOutbreak?r("v-sheet",{attrs:{dark:"",color:"red"},on:{click:e.btnCopeImageOutbreak}},[r("p",{staticClass:"pa-2"},[r("v-icon",[e._v("mdi-led-on")]),e._v(" 돌발상황 발생 ...! ")],1)]):e._e()],1)],1)],1),r("v-fab-transition",[r("v-overlay",{attrs:{absolute:e.oxygenOverAbsolute,value:e.oxygenOverlay}},[e.oxygenImgIsShow?r("v-img",{attrs:{src:e.oxygenImgSrc,"max-width":e.oxygen_maxWidth}},[r("v-btn",{attrs:{color:"success",bottom:"",right:"",absolute:""},on:{click:e.btnCloseOxygenDensityHealthObstacle}},[e._v(" Close ")])],1):e.isCopeOutbreak?r("v-carousel",{attrs:{"hide-delimiters":"",height:e.cope_height},model:{value:e.copeCarousel,callback:function(t){e.copeCarousel=t},expression:"copeCarousel"}},e._l(e.copeItems,(function(t,i){return r("v-carousel-item",{key:i},[r("v-img",{attrs:{src:t.src,cotain:"","max-width":e.cope_max_width}},[r("v-btn",{attrs:{color:"success",bottom:"",right:"",absolute:""},on:{click:e.btnCloseCopeImageOutbreak}},[e._v(" Close ")])],1)],1)})),1):e._e()],1)],1),r("v-snackbar",{attrs:{vertical:e.snackbar.vertical},scopedSlots:e._u([{key:"action",fn:function(t){var i=t.attrs;return[r("v-btn",e._b({attrs:{color:"red",text:""},on:{click:function(t){e.snackbar.isSnackbar=!1}}},"v-btn",i,!1),[e._v(" Close ")])]}}]),model:{value:e.snackbar.isSnackbar,callback:function(t){e.$set(e.snackbar,"isSnackbar",t)},expression:"snackbar.isSnackbar"}},[e._v(" "+e._s(e.snackbar.message)+" ")])],1)},a=[],n=r("b85c"),o=r("1da1"),s=r("5530"),l=(r("96cf"),r("d3b7"),r("a15b"),r("4de4"),r("b0c0"),r("b680"),r("2f62")),c=r("0063"),u=r("7e91"),h=r("57a1"),y=(r("fda2"),r("7aaa")),d=r("6c14"),m=r("cf80"),p="workStore",k="workerStore",v="tdmotionStore",g="workTdmotionStore",b="workerTdmotionStore",_="equipmentStore",f="workEquipmentStore",O="workerEquipmentStore",T="resultStore",x="resultItemStore",w={name:"choke_work",components:{VideoPlayerList:u["a"],VideoPlayering:h["a"]},mixins:[y["a"],d["a"]],data:function(){return{player:null,response:null,playerTitle:"",playerListPrevousIndex:-1,playerListCurrentIndex:0,playerListNextIndex:1,playerListLastIndex:-1,videoOptions:{controls:!0,fluid:!0,techOrder:["html5"],plugins:{playlist:{autoadvance:!0}}},videoList:[],isBtnPlayer:!1,playerVideoState:"",playerNormalCurrentTime:0,normalVideoLength:0,playerDrawer:null,playerVideoMotionType:"normal",isShowOxygenVideoPlay:!1,isTimerRunning:!1,timeWork:0,timerInterval:null,healthTick:5,oxygenTick:3,workerHealthInterval:null,workOxygenInterval:null,playerBtnNextHidden:!1,playerOverlay:!1,playerOverAbsolute:!0,hasOutbreakPlayTime:0,outbreakPlayTime:0,escapePlayTime:0,measurePlayTime:0,isOutbreak:!1,isPrepareOutbreak:!1,outbreakPlayerIndex:0,outbreakTime:0,prepareOutbreakTime:15,isCopeOutbreak:!1,copeCarousel:0,copeItems:[{src:r("78c9")},{src:r("bb59")},{src:r("af8a")},{src:r("1133")},{src:r("ec8d")}],workerHealth:{state:{color:"green",msg:""},range:{type:"range",min:0,max:100,value:100,step:1,orient:"vertical"},interval:null},workerHealthValue:100,oxygenDensity:{state:{color:"green",msg:""},range:{type:"range",min:0,max:23.5,value:23.5,step:1,orient:"vertical"},interval:null},oxygenDensityGauge:21,oxygenImgSrc:"",oxygenImgIsShow:!1,oxygenOverlay:!1,oxygenOverAbsolute:!0,workStep:{type:"normal",step:"0"},resultItemPayload:{index:0,resultItem:[]},snackbar:{isSnackbar:!1,vertical:!0,message:""},gitUrl:"https://goguy.github.io/mts-vv-kit"}},computed:Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["c"])(p,["GE_WORK_LIST"])),Object(l["c"])(k,["GE_WORKER"])),Object(l["c"])(v,["GE_TDMOTION_LIST"])),Object(l["c"])(g,["GE_WORK_TDMOTION_LIST"])),Object(l["c"])(b,["GE_WORKER_TDMOTION_LIST"])),Object(l["c"])(_,["GE_EQUIPMENT_LIST"])),Object(l["c"])(f,["GE_WORK_EQUIPMENT_LIST"])),Object(l["c"])(O,["GE_WORKER_EQUIPMENT_LIST"])),Object(l["c"])(T,["GE_RESULT","GE_RESULT_LIST"])),Object(l["c"])(x,["GE_RESULT_ITEM","GE_RESULT_ITEM_LIST"])),{},{subjectPlayerList:function(){var e=this,t=c["a"].from(this.GE_TDMOTION_LIST).join(c["a"].from(this.GE_WORK_TDMOTION_LIST).where((function(t){return t.work_id===e.GE_WORKER.work_id&&t.type===e.playerVideoMotionType})),(function(e){return e.motion_id}),(function(e){return e.motion_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),t)})).orderBy((function(e){return e.disp_ord})).toArray();return t},workName:function(){var e=this,t=this.GE_WORK_LIST.filter((function(t){return t.work_id===e.GE_WORKER.work_id}));return t[0].name},workingTime:function(){var e=this.timeWork/60,t=parseInt(e),r=Math.round(60*(e-t));return t<10&&(t="0"+t),r<10&&(r="0"+r),t+":"+r},workTotalTime:function(){var e=this,t=this.GE_WORK_LIST.filter((function(t){return t.work_id===e.GE_WORKER.work_id}));return t[0].time},equipPenalty:function(){var e=this.queryWorkEquipment("protect").length-this.queryWorkAndWorkerEquipment("protect").length+(this.queryWorkEquipment("safety").length-this.queryWorkAndWorkerEquipment("safety").length);return e},oxygen_maxWidth:function(){var e=this.$vuetify.breakpoint.xsOnly?"400":"615";return e},cope_height:function(){var e=this.$vuetify.breakpoint.xsOnly?"545":"818";return e},cope_max_width:function(){var e=this.$vuetify.breakpoint.xsOnly?"400":"600";return e},checkWatchAllVideo:function(){return this.queryWorkTdmotion.length===this.workAndworkerTdmotion.length},queryWorkTdmotion:function(){var e=this,t=c["a"].from(this.GE_TDMOTION_LIST).where((function(e){return"normal"===e.type})).join(c["a"].from(this.GE_WORK_TDMOTION_LIST).where((function(t){return t.work_id===e.GE_WORKER.work_id})),(function(e){return e.motion_id}),(function(e){return e.motion_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),t)})).toArray();return t},queryWorkerTdmotion:function(){var e=this,t=c["a"].from(this.GE_TDMOTION_LIST).where((function(e){return"normal"===e.type})).join(c["a"].from(this.GE_WORKER_TDMOTION_LIST).where((function(t){return t.worker_id===e.GE_WORKER.worker_id})),(function(e){return e.motion_id}),(function(e){return e.motion_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),t)})).toArray();return t},workAndworkerTdmotion:function(){var e=c["a"].from(this.queryWorkTdmotion).join(c["a"].from(this.queryWorkerTdmotion),(function(e){return e.motion_id}),(function(e){return e.motion_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),{},{right:t})})).toArray();return e}}),watch:{timeWork:function(e){e===this.outbreakTime-this.prepareOutbreakTime&&(this.isPrepareOutbreak=!0),e===this.outbreakTime&&this.setOutbreakVideoPlayer(),this.checkWatchAllVideo&&this.setWorkStep("normal","last")},isBtnPlayer:function(e){console.log("isBtnPlayer",e),this.isOutbreak&&(e&&(this.healthTick=((this.outbreakPlayTime-this.player.currentTime())/this.workerHealthValue).toFixed(3),this.startHealthTimer(this.healthTick,0,1),this.oxygenTick=((this.outbreakPlayTime-this.player.currentTime())/this.oxygenDensityGauge).toFixed(3),this.startOxygenTimer(this.oxygenTick,e,1)),e||(this.stopHealthTimer(),this.stopOxygenTimer()))},isOutbreak:function(e){e&&(this.isShowOxygenVideoPlay=!1,this.isBtnPlayer&&(this.healthTick=(this.outbreakPlayTime/this.workerHealthValue).toFixed(3),this.startHealthTimer(this.healthTick,0,1),this.oxygenTick=(this.outbreakPlayTime/this.oxygenDensityGauge).toFixed(3),this.startOxygenTimer(this.oxygenTick,e,1)))},isPrepareOutbreak:function(e){e&&this.getPrepareOutbreakAudio()},workerHealthValue:function(e){0===e&&this.setWorkStep("outbreak","last")},oxygenDensityGauge:function(e){0===e&&this.setWorkStep("outbreak","last")}},created:function(){this.normalVideoLength=this.videoListQuery("normal")},mounted:function(){this.response&&this.onPlayer(),this.startTimer(),this.startHealthTimer(this.healthTick,this.equipPenalty,1),this.startOxygenTimer(this.oxygenTick,this.isOutbreak,1),this.outbreakPlayerIndex=this.getOutbreakTimeMotionIndex(),console.log("this.outbreakPlayerIndex",this.outbreakPlayerIndex),this.outbreakPlayTime=this.getMotionPlayTime("outbreak"),this.escapePlayTime=this.getMotionPlayTime("escape"),this.measurePlayTime=this.getMotionPlayTime("measure"),console.log("outbreakPlayTime",this.outbreakPlayTime),console.log("hasOutbreakPlayTime",this.hasOutbreakPlayTime)},beforeDestroy:function(){this.player&&this.player.dispose(),clearInterval(this.workOxygenInterval),clearInterval(this.workerHealthInterval),clearInterval(this.timerInterval)},methods:Object(s["a"])(Object(s["a"])(Object(s["a"])({},Object(l["b"])(T,["AC_RESULT_EDIT"])),Object(l["b"])(x,["AC_RESULT_ITEM_EDIT"])),{},{initQuery:function(){},onPlayer:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.player=e,r.next=3,t.player.playlist(t.videoList);case 3:t.response=r.sent,t.playerListLastIndex=t.player.playlist.lastIndex();case 5:case"end":return r.stop()}}),r)})))()},onPlayerState:function(e){switch(e.type){case"play":console.log("player : "+e.type),this.playerBtnNextHidden=!1,this.isBtnPlayer=!0,this.playerVideoState=e.type;break;case"pause":console.log("player : "+e.type),this.isBtnPlayer=!1,this.playerVideoState=e.type;break;case"ended":console.log("player : "+e.type),this.playerVideoState=e.type,this.videoList&&this.tdmotionWorker(this.GE_WORKER.worker_id,this.videoList[this.playerListCurrentIndex].sources[0].motion_id),this.videoList.length-this.playerListCurrentIndex>1&&(this.playerBtnNextHidden=!0);break;case"loadeddata":console.log("player : "+e.type),this.playerListPrevousIndex=this.player.playlist.previousIndex(),this.playerListCurrentIndex=this.player.playlist.currentItem(),this.playerListNextIndex=this.player.playlist.nextIndex(),this.changePlayerTitle(),this.setOutbreakTimeIndex(this.player.playlist.currentItem());break;case"waiting":console.log("player : "+e.type);break;case"playing":console.log("player : "+e.type);break;case"canplay":console.log("player : "+e.type);break;case"canplaythrough":console.log("player : "+e.type);break;default:console.log("default")}this.setHistoryActivityWorker(e.type)},setHistoryActivityWorker:function(e){var t=this;setTimeout((function(){return t.historyActivityWorker(t.getActivityId("작업하기"),t.GE_WORKER.worker_id,"TDMOTION",t.videoList[t.playerListCurrentIndex].sources[0].motion_id,e,t.playerListCurrentIndex)}),500)},btnPlayWork:function(){this.player.play()},btnStopWork:function(){this.player.pause()},changePlayerTitle:function(){this.playerTitle=this.videoList[this.playerListCurrentIndex].sources.length>0?this.videoList[this.playerListCurrentIndex].sources[0].name:"noTitle"},vjsPlayerListLink:function(e){console.log("n : "+e),this.player.playlist.currentItem(e-1)},previousPlayer:function(){this.player.playlist.previous()},nextPlayer:function(){this.player.playlist.next()},videoListQuery:function(e){var t=this;try{var r=c["a"].from(this.GE_TDMOTION_LIST).join(c["a"].from(this.GE_WORK_TDMOTION_LIST).where((function(r){return r.work_id===t.GE_WORKER.work_id&&r.type===e})),(function(e){return e.motion_id}),(function(e){return e.motion_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),t)})).orderBy((function(e){return e.disp_ord})).toArray();this.videoList=[];var i,a=Object(n["a"])(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;this.videoList.push({sources:[{motion_id:o.motion_id,disaster_id:o.disaster_id,name:o.name,order:o.disp_ord-1,src:this.getVideoUrl(o.video_url),type:o.video_type}],poster:this.getImageUrl(o.img_url)})}}catch(l){a.e(l)}finally{a.f()}return this.videoList.length}catch(u){console.log("e : "+u)}},getWorkTime:function(){var e=this,t=this.GE_WORK_LIST.filter((function(t){return t.work_id===e.GE_WORKER.work_id}));return t.length>0?t[0].time:100},setWorkerEquipment:function(){var e="보호구장비 "+this.queryWorkAndWorkerEquipment("protect").length+"/"+this.queryWorkEquipment("protect").length+", 안전장비"+this.queryWorkAndWorkerEquipment("safety").length+"/"+this.queryWorkEquipment("safety").length;return e},queryWorkAndWorkerEquipment:function(e){var t=c["a"].from(this.queryWorkEquipment(e)).join(c["a"].from(this.queryWorkerEquipment(e)),(function(e){return e.equipment_id}),(function(e){return e.equipment_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),{},{right:t})})).toArray();return t},queryWorkEquipment:function(e){var t=this,r=c["a"].from(this.GE_EQUIPMENT_LIST).join(c["a"].from(this.GE_WORK_EQUIPMENT_LIST).where((function(e){return e.work_id===t.GE_WORKER.work_id})),(function(e){return e.equipment_id}),(function(e){return e.equipment_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),t)})).where((function(t){return t.type===e})).orderBy((function(e){return e.disp_ord})).toArray();return r},queryWorkerEquipment:function(e){var t=this,r=c["a"].from(this.GE_EQUIPMENT_LIST).join(c["a"].from(this.GE_WORKER_EQUIPMENT_LIST).where((function(e){return e.worker_id===t.GE_WORKER.worker_id})),(function(e){return e.equipment_id}),(function(e){return e.equipment_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),t)})).where((function(t){return t.type===e})).orderBy((function(e){return e.disp_ord})).toArray();return r},validate:function(e){var t=this.checkTypeResult();t?(this.recordWorkerResultItem("outbreak_cope",e),this.nextStep()):alert("돌발상황 발생 대처여부 업데이트 실패"),console.log("val",e)},nextStep:function(){this.checkWorkTime(),this.activityWorker(this.GE_WORKER.worker_id,this.getActivityId("작업하기")),this.dialog=!1,this.$router.push("/work/reporting")},checkWorkTime:function(){var e=this.checkTypeResult();this.timeWork>this.workTotalTime?e?this.recordWorkerResultItem("work_time","N"):alert("작업시간 준수여부 업데이트 실패"):e?this.recordWorkerResultItem("work_time","Y"):alert("작업시간 준수여부 업데이트 실패")},makeWorkingTime:function(e){var t=e/60,r=parseInt(t),i=Math.round(60*(t-r));return r<10&&(r="0"+r),i<10&&(i="0"+i),r+":"+i},getOutbreakTimeMotionIndex:function(){var e=this,t=c["a"].from(this.GE_WORK_LIST).where((function(t){return t.work_id===e.GE_WORKER.work_id})).join(c["a"].from(this.GE_WORK_TDMOTION_LIST),(function(e){return e.work_id}),(function(e){return e.work_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),t)})).join(c["a"].from(this.GE_TDMOTION_LIST).where((function(e){return"Y"===e.is_outbreak&&"normal"===e.type})),(function(e){return e.motion_id}),(function(e){return e.motion_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),t)})).toArray();return t.length>0?(this.hasOutbreakPlayTime=t[0].play_time,t[0].disp_ord):0},setOutbreakTimeIndex:function(e){if(!this.isOutbreak&&(console.log("val",e),console.log("this.outbreakPlayerIndex",this.outbreakPlayerIndex),this.outbreakPlayerIndex===e+1)){var t=60;console.log("timeWork",this.timeWork),console.log("outbreakTime",t),-1!==this.outbreakTime&&(this.setOutbreakTime(t),this.outbreakTime+=this.timeWork),console.log("this.outbreakTime",this.outbreakTime)}},setOutbreakTime:function(e){var t=.6*e,r=.1*e;this.outbreakTime=m["a"].NormalDistribution(t,r),this.outbreakTime=Math.round(this.outbreakTime,0),console.log("this.outbreakTime : "+this.outbreakTime)},setOutbreakVideoPlayer:function(){this.isPrepareOutbreak=!1,this.playerNormalCurrentTime=this.player.currentTime(),console.log("playerNormalCurrentTime",this.playerNormalCurrentTime),this.isOutbreak=!0,this.setWorkStep("outbreak","1"),this.playVideoPlayer("outbreak"),this.stopHealthTimer(),this.stopOxygenTimer()},getPrepareOutbreakAudio:function(){var e=new Audio("/audios/beep1.mp3");e.loop=!0,e.volume=.2,e.play(),setTimeout((function(){return e.pause()}),3e3)},btnCopeImageOutbreak:function(){this.oxygenOverlay=!0},btnCloseCopeImageOutbreak:function(){this.oxygenOverlay=!1},setWorkStep:function(e,t){this.workStep.type=e,this.workStep.step=t},btnOxygenDensity:function(){var e=this;if(0!==this.checkOxygenEquip())if(this.isShowOxygenVideoPlay)this.isShowOxygenVideoPlay&&(this.isShowOxygenVideoPlay=!1,this.isBtnPlayer&&this.player.play());else{this.isShowOxygenVideoPlay=!0,this.isBtnPlayer&&(this.player.pause(),setTimeout((function(){return e.isBtnPlayer=!0}),500)),this.playOxygenVideoPlayer(),this.plusWorkerHealthValue(10);var t=this.checkTypeResult();this.isPrepareOutbreak?t?this.recordWorkerResultItem("outbreak_recognize","Y"):alert("돌발상황 발생 인지여부 업데이트 실패"):t?this.recordWorkerResultItem("work_check","Y"):alert("작업 중 산소농도 측정여부 업데이트 실패")}else this.setSnackbar("산소농도를 측정하는 장비가 없습니다.")},plusWorkerHealthValue:function(e){this.workerHealthValue+e>100?this.workerHealthValue=100:this.workerHealthValue+=e},btnCopeOutbreak:function(){console.log("btnCopeOutbreak"),this.stopHealthTimer(),this.stopOxygenTimer(),this.startHealthTimer(5,0,1),this.startOxygenTimer(3,!0,1),this.isOutbreak=!1,this.outbreakTime=-1,this.isCopeOutbreak=!0,this.setWorkStep("normal","1"),this.playVideoPlayer("escape")},btnNomalVideoPlayer:function(){this.stopHealthTimer(),this.stopOxygenTimer(),this.startHealthTimer(5,0,1),this.startOxygenTimer(3,this.isOutbreak,1),this.isCopeOutbreak=!1,this.setWorkStep("normal","0"),this.playVideoPlayer("normal")},playOxygenVideoPlayer:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null!==e.$refs.measureVideoPlayering.playering){t.next=10;break}if(r=e.setMeasurePlayeringOptions("measure"),null==r){t.next=7;break}return t.next=5,e.$refs.measureVideoPlayering.playingVideo(r);case 5:t.next=8;break;case 7:alert("문제가 발생했습니다. 관리자에게 문의바랍니다.");case 8:t.next=11;break;case 10:e.$refs.measureVideoPlayering.playering.play();case 11:case"end":return t.stop()}}),t)})))()},checkOxygenEquip:function(){var e=this.queryWorkAndWorkerEquipment("safety").filter((function(e){return"산소농도측정기"===e.name}));return console.log("query.length",e.length),e.length},setMeasurePlayeringOptions:function(e){var t=this,r=null,i=c["a"].from(this.GE_TDMOTION_LIST).where((function(t){return t.type===e})).join(c["a"].from(this.GE_WORK_TDMOTION_LIST).where((function(e){return e.work_id===t.GE_WORKER.work_id})),(function(e){return e.motion_id}),(function(e){return e.motion_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),t)})).orderBy((function(e){return e.disp_ord})).toArray();return 1===i.length&&(r={autoplay:!0,controls:!0,fluid:!0,sources:[{src:this.getVideoUrl(i[0].video_url),type:i[0].video_type}],poster:this.getImageUrl(i[0].img_url)}),r},getVideoUrl:function(e){var t=e.substring(e.lastIndexOf("/"),e.length);return t=this.gitUrl+"/videos"+t,t},getImageUrl:function(e){var t=e.substring(e.lastIndexOf("/"),e.length);return t=this.gitUrl+"/images"+t,t},playVideoPlayer:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.playerVideoMotionType=e,t.videoListQuery(e),!(t.videoList.length>0)){r.next=7;break}return r.next=5,t.player.playlist(t.videoList);case 5:t.response=r.sent,"normal"===e?(t.player.playlist.currentItem(t.outbreakPlayerIndex-1),t.player.currentTime(t.playerNormalCurrentTime),t.player.play()):t.player.playlist.first();case 7:case"end":return r.stop()}}),r)})))()},startTimer:function(){var e=this;this.isTimerRunning=!0,this.timerInterval=setInterval((function(){e.timeWork++}),1e3)},startHealthTimer:function(e,t,r){var i=this;0!==this.equipPenalty&&(this.workerHealthValue-=t),this.workerHealthInterval=setInterval((function(){i.calcWorkerHealth(r),i.workerHealth.state=m["a"].workerHealthState(i.workerHealthValue)}),1e3*e)},calcWorkerHealth:function(e){this.workerHealthValue-e<=0?this.workerHealthValue=0:this.workerHealthValue>100?this.workerHealthValue=100:this.workerHealthValue=this.workerHealthValue-e},stopHealthTimer:function(){clearInterval(this.workerHealthInterval),this.workerHealthInterval=null},startOxygenTimer:function(e,t,r){var i=this;this.workOxygenInterval=setInterval((function(){i.calcWorkOxygen(t,r),i.oxygenDensity.state=m["a"].oxygenDensityState(i.oxygenDensityGauge)}),1e3*e)},calcWorkOxygen:function(e,t){e?this.outbreakWorkOxygen(t):this.normalWorkOxygen()},normalWorkOxygen:function(){var e=m["a"].generateRandom(19,23.5);this.oxygenDensityGauge=e.toFixed(1)},outbreakWorkOxygen:function(e){if(this.oxygenDensityGauge-e<1)this.oxygenDensityGauge=0;else{var t=this.oxygenDensityGauge-e;this.oxygenDensityGauge=t.toFixed(1)}},stopOxygenTimer:function(){clearInterval(this.workOxygenInterval),this.workOxygenInterval=null},getMotionPlayTime:function(e){var t=this,r=c["a"].from(this.GE_TDMOTION_LIST).where((function(t){return t.type===e})).join(c["a"].from(this.GE_WORK_TDMOTION_LIST).where((function(e){return e.work_id===t.GE_WORKER.work_id})),(function(e){return e.motion_id}),(function(e){return e.motion_id}),(function(e,t){return Object(s["a"])(Object(s["a"])({},e),t)})).orderBy((function(e){return e.disp_ord})).first();return void 0!==r.play_time?r.play_time:0},btnOxygenDensityHealthObstacle:function(){this.oxygenOverlay=!0,this.oxygenImgIsShow=!0,this.oxygenImgSrc=r("319e")},btnCloseOxygenDensityHealthObstacle:function(){this.oxygenOverlay=!1,this.oxygenImgIsShow=!1},checkTypeResult:function(){var e=this,t=this.GE_WORK_LIST.filter((function(t){return t.work_id===e.GE_WORKER.work_id}))[0].type,r=this.GE_RESULT_LIST.filter((function(e){return e.type===t}));return r.length>0},recordWorkerResultItem:function(e,t){var r=this,i=this.GE_WORK_LIST.filter((function(e){return e.work_id===r.GE_WORKER.work_id}))[0].type,a=this.GE_RESULT_LIST.filter((function(e){return e.type===i}))[0];a=this.GE_RESULT_ITEM_LIST.filter((function(t){return t.result_id===a.result_id&&t.name===e}))[0],a.worker_id=this.GE_WORKER.worker_id,a.is_yn=t,this.resultItemPayload.index=a.result_item_id,this.resultItemPayload.resultItem=a,this.AC_RESULT_ITEM_EDIT(this.resultItemPayload)},setSnackbar:function(e){this.snackbar.isSnackbar=!0,this.snackbar.message=e,this.snackbar.vertical=!0}})},I=w,E=(r("4ef3"),r("2877")),S=r("6544"),P=r.n(S),W=r("8212"),L=r("8336"),C=r("b0af"),R=r("5e66"),V=r("3e35"),j=r("62ad"),G=r("a523"),D=r("ce7e"),H=r("0789"),q=r("132d"),N=r("adda"),M=r("8860"),K=r("da13"),A=r("8270"),B=r("5d23"),U=r("1baa"),Q=r("f774"),$=r("a797"),F=r("490a"),z=r("0fd9"),Y=r("8dd9"),J=r("ba0d"),X=r("2db4"),Z=r("e0c7"),ee=Object(E["a"])(I,i,a,!1,null,null,null);t["default"]=ee.exports;P()(ee,{VAvatar:W["a"],VBtn:L["a"],VCard:C["a"],VCarousel:R["a"],VCarouselItem:V["a"],VCol:j["a"],VContainer:G["a"],VDivider:D["a"],VFabTransition:H["c"],VFadeTransition:H["d"],VIcon:q["a"],VImg:N["a"],VList:M["a"],VListItem:K["a"],VListItemAvatar:A["a"],VListItemContent:B["a"],VListItemGroup:U["a"],VListItemTitle:B["c"],VNavigationDrawer:Q["a"],VOverlay:$["a"],VProgressCircular:F["a"],VRow:z["a"],VSheet:Y["a"],VSlider:J["a"],VSnackbar:X["a"],VSubheader:Z["a"]})},"4ef3":function(e,t,r){"use strict";r("2b97")}}]);
//# sourceMappingURL=chunk-70db0c69.e2ffc33e.js.map